!function(){var e={openSignUpModal:function(o){var i=_.extend({},o,e.getSignUpModalOptions());e.triggerUserSessionModal(window.openSignUpModal,i,"join")},openSignInModal:function(o){e.triggerUserSessionModal(window.openSignInModal,o,"login")},triggerUserSessionModal:function(o,i,n){var r=_.get(i,"forceModal",!1),t=this.isMobileResponsive()&&!r;return t?void e.redirectToStandalonePage(n):o?void o(i):(e.reportTriggerFail(n),void e.redirectToStandalonePage(n))},reportTriggerFail:function(o){var i="signing_modal_trigger.fail."+o;e.graph(i)},redirectToStandalonePage:function(e){document.location="/"+e+location.search},getSignUpModalOptions:function(){if(e.isReferralEmailFlow()){var o=ft.utl.getUrlVars();return{forceModal:!0,isSticky:!0,initialValues:{email:decodeURIComponent(o.referral_email)}}}return{}},isReferralEmailFlow:function(){var e=ft.utl.getUrlVars();return!!e.referral_email},reportSignUpClickMixpanelEvent:function(o){e.reportPopupMixpanelEvent(MixpanelWrapper.Events.UserEvents.CLICKED_JOIN,o)},reportSignInClickMixpanelEvent:function(o){e.reportPopupMixpanelEvent(MixpanelWrapper.Events.UserEvents.CLICKED_LOGIN,o)},reportSignInSuccessMixpanelEvent:function(){MixpanelWrapper.trackEvent(MixpanelWrapper.Events.LoginEvents.LOGGED_IN_SUCCESSFULLY,{Provider:"Standard"})},reportPopupMixpanelEvent:function(e,o){MixpanelWrapper.trackEvent(e,{"Source Component":o,"View Type":"Pop-up"})},graph:function(e){Fiverr._broadcastLogEvents({facility:"graphite",type:"long_counter",label:"signing_event."+e,value:1})},submitCheckout:function(e,o){return o?(fGuestCheckout.submitForm(e,o),!0):window.fAnywhereCheckout?(fAnywhereCheckout.submitForm(e),!0):!1},handleAutoShowSignUp:function(){e.shouldAutoShowSignUpModal()&&(e.setAutoShownSignUp(),e.delayModalOpen(function(){e.openSignUpModal({forceModal:!0})}))},shouldAutoShowSignUpModal:function(){var o=e.isAlreadyAutoShownSignUp(),i=!!ft.utl.getUrlVars().show_join,n=Fiverr.models.ps.push_join_lightbox&&!o;return i||n},isAlreadyAutoShownSignUp:function(){return ft.utl.getLS("popup-join-shown",!0,!0)},setAutoShownSignUp:function(){ft.utl.setLS("popup-join-shown",!0,!0)},delayModalOpen:function(e){setTimeout(function(){e()},2e3)},isMobileResponsive:function(){return _.get(document.pageScope,"isMobileResponsive",!1)}};window.fLoginFormsUtils=e}(),function(e){var o={models:{c:Fiverr.models.context,b:Fiverr.models.browser,user:Fiverr.models.user,ps:Fiverr.models.ps,eventsDictionary:{click:{join:"signup_click",login:"login_click"}}},init:function(){this.bindModalTriggers(),this.shouldShowEmailReferralSignUp()||fLoginFormsUtils.handleAutoShowSignUp()},bindModalTriggers:function(){this.bindSignUpTrigger(),this.bindSignInTrigger()},bindSignUpTrigger:function(){var i=this,n=i.models;e(document.body).on("click",".js-open-popup-join",function(r){r.preventDefault();var t=e.cookie("guest_request_data"),a=e(this),l=a.data("eventType"),s=a.data("source-component");if(fLoginFormsUtils.reportSignUpClickMixpanelEvent(s),i.reportEvent("click","join"),o.reportToBigQuery(l),i.setRedirectUrlCookie(a.data("redirect-url")),t){var p=t.split(":")[0];return void o.shouldShowEmailReferralSignUp(p)}if(a.parents().hasClass("js-gig-collect")&&n.ps.gig_id){var u=new Date;u.setTime(u.getTime()+3e5),ft.utl.setCookie("collecting",n.ps.gig_id,u)}fLoginFormsUtils.openSignUpModal()})},bindSignInTrigger:function(){var i=this;e(document.body).on("click",".js-open-popup-login",function(n){n.preventDefault();var r=e(this),t=r.data("eventType"),a=!!r.data("forceModal"),l=r.data("source-component");fLoginFormsUtils.reportSignInClickMixpanelEvent(l),i.reportEvent("click","login"),o.reportToBigQuery(t),i.setRedirectUrlCookie(r.data("redirect-url")),fLoginFormsUtils.openSignInModal({forceModal:a})})},reportToBigQuery:function(o,i){if(o){var n={type:o,group:"signin flow",aux:{uid:e.cookie("u_guid"),http_request:{referrer:e.cookie("session_referer")}}};"undefined"!=typeof i&&(n.event_source=i),Fiverr.sendClientEvents(n)}},getEmailParameter:function(o){var i=e.cookie("team_member_email");return o.referral_email?decodeURIComponent(o.referral_email):i?(ft.utl.removeCookie("team_member_email"),i):""},shouldShowEmailReferralSignUp:function(e){var i=ft.utl.getUrlVars(),n=e||this.getEmailParameter(i);if(n&&!i.show_join){var r=ft.utl.setUrlVars({url:"/",params:{show_join:"true",referral_email:n}});return o.redirectTo(r),!0}return n?(window.fLoginFormsUtils.delayModalOpen(function(){window.fLoginFormsUtils.openSignUpModal()}),!0):!1},setRedirectUrlCookie:function(e){if(e){var o=new Date;o.setTime(o.getTime()+3e5),ft.utl.setCookie("redirect_url",e,o)}else this.unsetRedirectUrlCookie()},unsetRedirectUrlCookie:function(){ft.utl.removeCookie("redirect_url")},reportEvent:function(e,i){var n=this,r=n.models,t=ft.utl.resolve(ft.utl.interpolate("%{0}.%{1}",arguments),r.eventsDictionary);o.reportKey(t,1)},reportKey:function(e,i){e&&i&&(Fiverr._broadcastLogEvents({facility:"aux_data",label:e,value:i},{facility:"graphite",type:"long_counter",label:"signing_event.{platform}.{browser}.form_interaction."+e,value:i}),o.reportToBigQuery(e))},redirectTo:function(e){var o=new RegExp("^"+window.location.origin),i=window.location.href.replace(o,"");i===e?window.location.reload():document.location.href=e}};window.fLoginForms=o,e.once("fiverr-global-parsed",_.bind(o.init,o))}(jQuery);